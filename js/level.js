const LEVEL_RAW = `
------------------------------------------------------------------------------------------------------------------------
------------------------------------------------------------------------------------------------------------------------
------------------------------------------------------------------------------------------------------------------------
------------------------------------------------------------------------------------------------------------------------
------------------------------------------------------------------------------------------------------------------------
------------------------------------------------------------------------------------------------------------------------
------------------------------------------------------------------------------------------------------------------------
------------------------------------------------------------------------------------------------------------------------
------------------------------------------------------------------------------------------------------------------------
------------------------------------------------------------------------------------------------------------------------
------------------------------------------------------------------------------------------------------------------------
-------------------------------------------#################################--------------------------------------------
-----------------------------------####---------------------------------------------------------------------------------
------------------------------------------------------------------------------------------------------------------------
------------P------------------####-------------------------------------------------------------------------------------
------------------------------------------------------------------------------------------------------------------------
-----############################------------------------------------###########################------######------######
------------------------------------------------------------------------------------------------------------------------
------------------------------------------------------------------------------------------------------------------------
------------------------------------------------------------------------------------------------------------------------
`;

const TILES = {
    EMPTY: "-",
    BLOCK: "#",
    PLAYER: "P",
};
const TILE_SIZE = {
    w: 32.0,
    h: 32.0,
};

function loadLevel(raw = LEVEL_RAW) {
    player = null;
    camera = { x: 0.0, y: 0.0 };
    entities = [];

    const rows = raw.split("\n");
    for (let y = 0; y < rows.length; y++) {
        const row = rows[y];
        for (let x = 0; x < row.length; x++) {
            let tile = row[x];
            const pos = { x: x * TILE_SIZE.w, y: y * TILE_SIZE.h };
            switch (tile) {
                case TILES.EMPTY:
                    break;
                case TILES.BLOCK:
                    createEntity(new Block(pos.x, pos.y));
                    break;
                case TILES.PLAYER:
                    console.log(pos);
                    player = new Player(pos.x, pos.y);
                    createEntity(player);
                    break;
                default:
                    console.warn(`Invalid tile char: ${tile}`);
            }
        }
    }

    if (player) {
        camera = {
            x: player.position.x,
            y: player.position.y,
        };
    }
}
